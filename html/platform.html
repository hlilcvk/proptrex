<!DOCTYPE html>
<html lang="en" data-lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PROPTREX ‚Äî Platform</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400&family=Outfit:wght@200;300;400;500;600;700&family=JetBrains+Mono:wght@300;400;500;600&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.2/babel.min.js"></script>
<style>
:root{
  --white:#fff;--cream:#f5f4f0;--g50:#f8f7f4;--g100:#eeedea;--g200:#e0dfdb;--g300:#c8c7c2;--g400:#9c9b96;--g500:#6e6d68;--g600:#4a4944;--g700:#333230;--g800:#1e1d1b;--g900:#0f0e0c;
  --ink:#0a0908;--ink2:#1a1918;--ink3:#3d3c3a;
  --blue:#0038ff;--blue-l:#e8edff;--green:#00875a;--green-l:#e6f5ef;--red:#e8432a;--red-l:#fef0ed;--gold:#c49a2a;--gold-l:#fdf8eb;--purple:#7c3aed;--purple-l:#f3eeff;--cyan:#0891b2;--cyan-l:#e8fafb;
  --ed:'Cormorant Garamond','Georgia',serif;--sans:'Outfit',-apple-system,sans-serif;--mono:'JetBrains Mono','SF Mono',monospace;
  --ease:cubic-bezier(.16,1,.3,1);
  --r-sm:8px;--r-md:14px;--r-lg:20px;
  --sh-s:0 1px 3px rgba(10,9,8,.04);--sh-c:0 4px 24px rgba(10,9,8,.06);--sh-e:0 12px 48px rgba(10,9,8,.08)
}
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
html,body,#root{height:100%;overflow:hidden}
body{background:var(--white);color:var(--ink);font-family:var(--sans);-webkit-font-smoothing:antialiased;line-height:1.5}
::selection{background:var(--blue);color:var(--white)}
::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-track{background:var(--g50)}::-webkit-scrollbar-thumb{background:var(--g300);border-radius:3px}
.tooltip-wrap{position:relative;display:inline-flex}
.tooltip-wrap:hover .tooltip-box{display:block}
.tooltip-box{display:none;position:absolute;bottom:calc(100% + 6px);left:50%;transform:translateX(-50%);background:var(--ink);color:var(--white);padding:4px 10px;border-radius:6px;font-size:10px;white-space:nowrap;z-index:999;pointer-events:none}
.modal-overlay{position:fixed;inset:0;background:rgba(10,9,8,.6);backdrop-filter:blur(8px);z-index:1000;display:flex;align-items:center;justify-content:center}
.modal-box{background:var(--white);border:1px solid var(--g200);border-radius:var(--r-lg);width:92vw;max-width:1200px;height:78vh;display:flex;flex-direction:column;overflow:hidden;box-shadow:var(--sh-e)}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}
</style>
</head>
<body>
<div id="root"></div>
<script type="text/babel" data-presets="react">
const {useState,useEffect,useRef,useCallback,useMemo}=React;

// ‚ïê‚ïê‚ïê DESIGN TOKENS (v4.1 light theme) ‚ïê‚ïê‚ïê
const T={white:"#fff",cream:"#f5f4f0",g50:"#f8f7f4",g100:"#eeedea",g200:"#e0dfdb",g300:"#c8c7c2",g400:"#9c9b96",g500:"#6e6d68",g600:"#4a4944",g700:"#333230",g800:"#1e1d1b",ink:"#0a0908",blue:"#0038ff",green:"#00875a",red:"#e8432a",gold:"#c49a2a",purple:"#7c3aed",cyan:"#0891b2"};
const fP=n=>{if(!n||isNaN(n))return"‚Äî";const v=Math.abs(n);if(v<1e-5)return"$"+n.toExponential(2);if(v<.01)return"$"+n.toFixed(6);if(v<1)return"$"+n.toFixed(4);if(v<1e3)return"$"+n.toFixed(2);return"$"+n.toLocaleString("en-US",{maximumFractionDigits:2})};
const fU=n=>{if(!n)return"‚Äî";const v=Math.abs(n);if(v>=1e12)return"$"+(n/1e12).toFixed(2)+"T";if(v>=1e9)return"$"+(n/1e9).toFixed(2)+"B";if(v>=1e6)return"$"+(n/1e6).toFixed(1)+"M";if(v>=1e3)return"$"+(n/1e3).toFixed(0)+"K";return"$"+n.toFixed(0)};
const fC=n=>n==null||isNaN(n)?"‚Äî":(n>0?"+":"")+Number(n).toFixed(2)+"%";
const pC=n=>(n??0)>0?T.green:(n??0)<0?T.red:T.g400;

// ‚ïê‚ïê‚ïê LANGUAGE ‚ïê‚ïê‚ïê
const LANG={
  en:{spot:"Spot",futures:"Futures",all:"All",defi:"DeFi",alerts:"Alerts",whales:"Whales",search:"Search coin...",symbol:"Symbol",type:"Type",exchange:"Exchange",price:"Price",change24:"24h%",volume:"Volume",mcap:"MCap",rsi:"RSI",fund:"Fund",score:"DIP SCORE",signal:"Signal",trade:"Trade",noData:"No data found",loading:"Scanning APIs...",fgLabel:"Fear & Greed",filterAll:"All",filterStrong:"Strong Buy",filterBuy:"Buy",filterWatch:"Watch",tvVol:"High Volume",tvGain:"Gainers",tvOversold:"Oversold",tvDip:"Dip Hunter",tvWhale:"Whale Track",chainTvl:"Chain TVL",trendTokens:"Trending",liveAlerts:"Live Alerts",last:"Last scan",chart:"Chart",openEx:"Trade",tvChart:"TradingView",close:"Close",crypto:"Crypto",cex:"CEX",dex:"DEX",stocks:"Stocks",etf:"ETF",bonds:"Bonds",forex:"Forex",platform:"Platform",social:"Social Feed",whaleBuy:"Buy",whaleSell:"Sell",whaleAll:"All",lang:"TR",home:"Home"},
  tr:{spot:"Spot",futures:"Vadeli",all:"T√ºm√º",defi:"DeFi",alerts:"Uyarƒ±lar",whales:"Balinalar",search:"Coin ara...",symbol:"Sembol",type:"Tip",exchange:"Borsa",price:"Fiyat",change24:"24s%",volume:"Hacim",mcap:"MCap",rsi:"RSI",fund:"Fund",score:"DIP SCORE",signal:"Sinyal",trade:"ƒ∞≈ülem",noData:"Veri bulunamadƒ±",loading:"API'ler taranƒ±yor...",fgLabel:"Korku & A√ßg√∂zl√ºl√ºk",filterAll:"T√ºm√º",filterStrong:"G√º√ßl√º Al",filterBuy:"Al",filterWatch:"ƒ∞zle",tvVol:"Y√ºksek Hacim",tvGain:"Y√ºkselenler",tvOversold:"A≈üƒ±rƒ± Satƒ±m",tvDip:"Dip Fƒ±rsatƒ±",tvWhale:"Balina Takip",chainTvl:"Zincir TVL",trendTokens:"Trendler",liveAlerts:"Canlƒ± Uyarƒ±lar",last:"Son tarama",chart:"Grafik",openEx:"ƒ∞≈ülem",tvChart:"TradingView",close:"Kapat",crypto:"Kripto",cex:"CEX",dex:"DEX",stocks:"Hisseler",etf:"ETF",bonds:"Tahvil",forex:"Forex",platform:"Platform",social:"Sosyal",whaleBuy:"Alƒ±mlar",whaleSell:"Satƒ±≈ülar",whaleAll:"T√ºm√º",lang:"EN",home:"Ana Sayfa"}
};

// ‚ïê‚ïê‚ïê MARKETS ‚ïê‚ïê‚ïê
const MARKETS={
  crypto:{id:"crypto",label:"Crypto",icon:"‚Çø",color:T.blue,sub:"DIP SCORE‚Ñ¢ + TV Scanner + Whales",agent:"CryptoSense AI",agentStatus:"SCANNING"},
  cex:{id:"cex",label:"CEX",icon:"‚ö°",color:T.gold,sub:"6 Exchange + Funding Rates",agent:"ExchangeRadar AI",agentStatus:"SCANNING"},
  dex:{id:"dex",label:"DEX",icon:"üîó",color:T.purple,sub:"DefiLlama + DexScreener",agent:"DeFiScout AI",agentStatus:"SCANNING"},
  stocks:{id:"stocks",label:"Stocks",icon:"üìä",color:T.blue,sub:"Global Indices + AI Signals",agent:"EquityPulse AI",agentStatus:"ACTIVE"},
  etf:{id:"etf",label:"ETF / BYF",icon:"üß©",color:T.cyan,sub:"Bitcoin ETF Flows + Fund Tracking",agent:"FundTracker AI",agentStatus:"ACTIVE"},
  bonds:{id:"bonds",label:"Bonds",icon:"üè¶",color:T.green,sub:"Yield Curve + Global 10Y",agent:"YieldSentinel AI",agentStatus:"ACTIVE"},
};

// ‚ïê‚ïê‚ïê EXCHANGES ‚ïê‚ïê‚ïê
const EX={
  binance:{id:"binance",n:"Binance",c:"#f3ba2f",l:s=>`https://www.binance.com/tr/trade/${s}_USDT`},
  bybit:{id:"bybit",n:"Bybit",c:"#f7a600",l:s=>`https://www.bybit.com/trade/usdt/${s}USDT`},
  okx:{id:"okx",n:"OKX",c:T.ink,l:s=>`https://www.okx.com/trade-spot/${s.toLowerCase()}-usdt`},
  gateio:{id:"gateio",n:"Gate.io",c:"#2354e6",l:s=>`https://www.gate.io/trade/${s}_USDT`},
  mexc:{id:"mexc",n:"MEXC",c:"#2a85ff",l:s=>`https://www.mexc.com/tr-TR/exchange/${s}_USDT`},
  bitget:{id:"bitget",n:"Bitget",c:T.cyan,l:s=>`https://www.bitget.com/spot/${s}USDT`},
};
const EXL=Object.values(EX);

// ‚ïê‚ïê‚ïê STATIC DATA ‚ïê‚ïê‚ïê
const WHALE_DB=[
  {id:"w1",short:"0x3f5C...a8D2",label:"Whale #1",action:"BUY",token:"PEPE",amount:1200000,chain:"ethereum",exchange:"Uniswap",age:1},
  {id:"w2",short:"7xKf...pQrS",label:"Whale #2",action:"BUY",token:"WIF",amount:340000,chain:"solana",exchange:"Jupiter",age:2},
  {id:"w3",short:"0x8b2A...eE3B",label:"Shark",action:"BUY",token:"ARB",amount:780000,chain:"arbitrum",exchange:"Uniswap",age:3},
  {id:"w4",short:"BnM2...zT1W",label:"Unknown",action:"SELL",token:"BONK",amount:220000,chain:"solana",exchange:"Raydium",age:4},
  {id:"w5",short:"0x1Da9...9Ab0",label:"Whale #3",action:"BUY",token:"LINK",amount:890000,chain:"ethereum",exchange:"Binance",age:5},
  {id:"w6",short:"4hTrV...mS8P",label:"Mid Whale",action:"BUY",token:"JUP",amount:150000,chain:"solana",exchange:"Jupiter",age:6},
  {id:"w7",short:"0x6Ef3...cB4D",label:"Whale #4",action:"BUY",token:"OP",amount:430000,chain:"optimism",exchange:"Uniswap",age:7},
  {id:"w8",short:"GmP5...hJ2K",label:"Unknown",action:"SELL",token:"RNDR",amount:560000,chain:"ethereum",exchange:"Coinbase",age:8},
];
const INDICES=[
  {n:"S&P 500",v:"6,124",ch:"+0.42%",up:true},{n:"NASDAQ",v:"19,842",ch:"+0.68%",up:true},
  {n:"BIST 100",v:"10,248",ch:"-0.31%",up:false},{n:"DAX",v:"22,614",ch:"+0.24%",up:true},
  {n:"Nikkei",v:"40,168",ch:"+0.92%",up:true},{n:"FTSE 100",v:"7,843",ch:"-0.09%",up:false},
];
const BONDS=[
  {n:"üá∫üá∏ US 10Y",v:"4.52%",ch:"+2bp",up:true},{n:"üá©üá™ Bund 10Y",v:"2.48%",ch:"-1bp",up:false},
  {n:"üá¨üáß Gilt 10Y",v:"4.61%",ch:"+3bp",up:true},{n:"üáØüáµ JGB 10Y",v:"1.08%",ch:"+1bp",up:true},
  {n:"üáπüá∑ TGOV 10Y",v:"26.8%",ch:"-12bp",up:false},
];
const ETF_FLOWS=[
  {n:"IBIT (BlackRock)",v:"+$284M",up:true},{n:"FBTC (Fidelity)",v:"+$142M",up:true},
  {n:"GBTC (Grayscale)",v:"-$38M",up:false},{n:"ARKB (ARK)",v:"+$67M",up:true},
];
const SOCIAL=[
  {src:"PumpFun",icon:"üéØ",msg:"BONK2 ‚Äî 500+ holders in 8 min",hot:true},
  {src:"Twitter",icon:"üê¶",msg:"@elonmusk DOGE retweet ‚Üí trending #1",hot:true},
  {src:"GMGN.ai",icon:"ü§ñ",msg:"Smart wallet $200K POPCAT buy",hot:true},
  {src:"Telegram",icon:"üì±",msg:"KOL call: PEPE2.0 accumulation",hot:true},
  {src:"CoinGecko",icon:"üìä",msg:"WIF trending #3 ‚Äî $1M daily new buyers",hot:false},
  {src:"Reuters",icon:"üì∞",msg:"Fed rate decision ‚Äî markets cautious",hot:false},
];

// ‚ïê‚ïê‚ïê API FETCHERS ‚ïê‚ïê‚ïê
const api=async(url,opt)=>{try{const r=await fetch(url,opt);if(!r.ok)throw r.status;return r.json()}catch(e){return null}};
const apiProxy=async(url)=>{
  let d=await api(url);if(d)return d;
  const proxies=["https://api.allorigins.win/raw?url=","https://corsproxy.io/?","https://api.codetabs.com/v1/proxy?quest="];
  for(const p of proxies){try{const r=await fetch(p+encodeURIComponent(url));if(r.ok){const j=await r.json();if(j)return j}}catch{}}
  return null
};
async function fetchBinanceSpot(){const d=await api("https://api.binance.com/api/v3/ticker/24hr");return(d||[]).filter(t=>t.symbol.endsWith("USDT")&&+t.quoteVolume>50000).map(t=>({sym:t.symbol.replace("USDT",""),ex:"binance",type:"SPOT",price:+t.lastPrice,ch:+t.priceChangePercent,vol:+t.quoteVolume,hi:+t.highPrice,lo:+t.lowPrice}))}
async function fetchBinanceFut(){const d=await api("https://fapi.binance.com/fapi/v1/ticker/24hr");return(d||[]).filter(t=>t.symbol.endsWith("USDT")&&+t.quoteVolume>100000).map(t=>({sym:t.symbol.replace("USDT",""),ex:"binance",type:"FUTURES",price:+t.lastPrice,ch:+t.priceChangePercent,vol:+t.quoteVolume}))}
async function fetchFunding(){const d=await api("https://fapi.binance.com/fapi/v1/premiumIndex");const m={};(d||[]).filter(t=>t.symbol.endsWith("USDT")).forEach(t=>m[t.symbol.replace("USDT","")]={fr:+t.lastFundingRate*100});return m}
async function fetchBybit(){const d=await api("https://api.bybit.com/v5/market/tickers?category=spot");return(d?.result?.list||[]).filter(t=>t.symbol.endsWith("USDT")&&+t.turnover24h>50000).map(t=>({sym:t.symbol.replace("USDT",""),ex:"bybit",type:"SPOT",price:+t.lastPrice,ch:+t.price24hPcnt*100,vol:+t.turnover24h}))}
async function fetchOKX(){const d=await api("https://www.okx.com/api/v5/market/tickers?instType=SPOT");return(d?.data||[]).filter(t=>t.instId.endsWith("-USDT")&&+t.volCcy24h>50000).map(t=>({sym:t.instId.replace("-USDT",""),ex:"okx",type:"SPOT",price:+t.last,ch:((+t.last-+t.open24h)/+t.open24h)*100,vol:+t.volCcy24h}))}
async function fetchGate(){const d=await apiProxy("https://api.gateio.ws/api/v4/spot/tickers");return(d||[]).filter(t=>t.currency_pair?.endsWith("_USDT")&&+t.quote_volume>50000).map(t=>({sym:t.currency_pair.replace("_USDT",""),ex:"gateio",type:"SPOT",price:+t.last,ch:+t.change_percentage,vol:+t.quote_volume}))}
async function fetchMEXC(){const d=await apiProxy("https://api.mexc.com/api/v3/ticker/24hr");return(d||[]).filter(t=>t.symbol?.endsWith("USDT")&&+t.quoteVolume>50000).map(t=>({sym:t.symbol.replace("USDT",""),ex:"mexc",type:"SPOT",price:+t.lastPrice,ch:+t.priceChangePercent,vol:+t.quoteVolume}))}
async function fetchBitget(){const d=await apiProxy("https://api.bitget.com/api/v2/spot/market/tickers");return(d?.data||[]).filter(t=>t.symbol?.endsWith("USDT")&&+t.quoteVolume>50000).map(t=>({sym:t.symbol.replace("USDT",""),ex:"bitget",type:"SPOT",price:+t.lastPr,ch:+t.change24h*100,vol:+t.quoteVolume}))}
async function fetchCG(){return await api("https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=250&page=1&sparkline=false&price_change_percentage=1h,24h,7d")}
async function fetchFG(){const d=await api("https://api.alternative.me/fng/?limit=1");return d?.data?.[0]||null}
async function fetchDL(){return await api("https://api.llama.fi/v2/chains")}
async function fetchDS(){return await api("https://api.dexscreener.com/token-boosts/top/v1")}
async function fetchTV(f="volume"){
  const fs={volume:[{left:"volume",operation:"greater",right:500000}],gainers:[{left:"change",operation:"greater",right:5},{left:"volume",operation:"greater",right:100000}],oversold:[{left:"RSI",operation:"less",right:35},{left:"volume",operation:"greater",right:100000}],dip:[{left:"change",operation:"less",right:-5},{left:"RSI",operation:"in_range",right:[25,45]}],whale:[{left:"volume",operation:"greater",right:5e6}]};
  const d=await api("https://scanner.tradingview.com/crypto/scan",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filter:fs[f]||fs.volume,options:{lang:"en"},markets:["crypto"],symbols:{query:{types:[]},tickers:[]},columns:["name","description","close","change","change_abs","volume","market_cap_calc","Recommend.All","RSI","RSI[1]","MACD.macd","MACD.signal","EMA20","EMA50","EMA200","Volatility.D","average_volume_10d_calc","exchange"],sort:{sortBy:"volume",sortOrder:"desc"},range:[0,200]})});
  const cols=["name","desc","close","change","chAbs","vol","mcap","rec","rsi","rsi1","macdM","macdS","ema20","ema50","ema200","volD","avgVol","exchange"];
  return(d?.data||[]).map(i=>{const o={_id:i.s};(i.d||[]).forEach((v,j)=>o[cols[j]]=v);return o})
}

function calcScore(t){
  let s=0;const sig=[];const risk=[];
  const rsi=t.rsi??50,ch=t.ch??0,rec=t.rec??0,vol=t.vol??0,avg=t.avgVol??1,p=t.price??0;
  const vr=avg>0?vol/avg:0;
  if(vr>5){s+=30;sig.push("üöÄ Vol x"+vr.toFixed(1))}else if(vr>2){s+=15;sig.push("üìà Vol x"+vr.toFixed(1))}
  if(rsi<30){s+=25;sig.push("‚ö° RSI:"+rsi.toFixed(0))}else if(rsi<40){s+=12;sig.push("üìâ RSI:"+rsi.toFixed(0))}else if(rsi>70){risk.push("‚ö†Ô∏è RSI:"+rsi.toFixed(0));s-=10}
  if(t.ema20&&t.ema50&&p>t.ema20&&t.ema20>t.ema50){s+=15;sig.push("üü¢ EMA‚Üë")}
  if(rec>0.5){s+=20;sig.push("üìä Strong Buy")}else if(rec<-0.3){risk.push("üìä Sell");s-=10}
  if(ch>5&&ch<25)s+=10;
  if(ch<-5&&rsi<40){s+=20;sig.push("üéØ Dip")}
  if(t.fr!=null&&t.fr<-0.01){s+=10;sig.push("üí∞ Fund:"+t.fr.toFixed(3)+"%")}
  s=Math.max(0,Math.min(s,100));
  const lv=s>=70?"STRONG":s>=45?"BUY":s>=25?"WATCH":"HOLD";
  return{score:s,level:lv,sig,risk}
}

// ‚ïê‚ïê‚ïê SMALL COMPONENTS ‚ïê‚ïê‚ïê
const Badge=({id})=>{const e=EX[id];if(!e)return null;return<span style={{fontSize:12,padding:"4px 10px",background:e.c+"12",border:"1px solid "+e.c+"28",color:e.c,borderRadius:100,fontWeight:600,fontFamily:"var(--mono)"}}>{e.n}</span>};
const SBar=({s,l})=>{const c=l==="STRONG"?T.green:l==="BUY"?T.blue:l==="WATCH"?T.gold:T.g400;return<span style={{display:"inline-flex",alignItems:"center",gap:4}}><span style={{width:56,height:7,background:T.g100,borderRadius:100,overflow:"hidden",display:"inline-block"}}><span style={{display:"block",height:"100%",width:s+"%",background:c,borderRadius:100}}/></span><span style={{color:c,fontSize:13,fontWeight:700,fontFamily:"var(--mono)"}}>{s}</span></span>};
const LPill=({l})=>{const m={STRONG:T.green,BUY:T.blue,WATCH:T.gold,HOLD:T.g400};const c=m[l]||T.g400;return<span style={{background:c+"14",color:c,borderRadius:100,padding:"4px 12px",fontSize:12,fontWeight:700,fontFamily:"var(--mono)",letterSpacing:.5}}>{l||"‚Äî"}</span>};
const TPill=({t})=>{const c=t==="SPOT"?T.blue:T.purple;return<span style={{background:c+"10",color:c,borderRadius:100,padding:"3px 10px",fontSize:11,fontWeight:700,fontFamily:"var(--mono)",letterSpacing:.5}}>{t}</span>};
const Tip=({text,children})=><div className="tooltip-wrap">{children}<div className="tooltip-box">{text}</div></div>;

// ‚ïê‚ïê‚ïê CHART MODAL ‚ïê‚ïê‚ïê
const ChartModal=({sym,onClose,L})=>{
  if(!sym)return null;const tvS="BINANCE:"+sym+"USDT";
  return<div className="modal-overlay" onClick={onClose}><div className="modal-box" onClick={e=>e.stopPropagation()}>
    <div style={{display:"flex",alignItems:"center",padding:"12px 20px",borderBottom:"1px solid var(--g200)",gap:12}}>
      <span style={{fontFamily:"var(--mono)",fontWeight:700,fontSize:20,color:T.ink}}>{sym}/USDT</span>
      <span style={{fontSize:14,color:T.g500}}>{L.chart}</span>
      <div style={{marginLeft:"auto",display:"flex",gap:8}}>
        <a href={`https://tr.tradingview.com/chart/?symbol=${tvS}`} target="_blank" rel="noopener noreferrer" style={{background:T.blue+"10",color:T.blue,borderRadius:8,padding:"6px 16px",fontSize:14,fontWeight:600,textDecoration:"none"}}>{L.tvChart} ‚Üó</a>
        <button onClick={onClose} style={{background:T.g50,border:"1px solid var(--g200)",color:T.g600,borderRadius:8,padding:"6px 16px",fontSize:14,fontWeight:600,cursor:"pointer"}}>‚úï</button>
      </div>
    </div>
    <iframe src={`https://s.tradingview.com/widgetembed/?frameElementId=tv&symbol=${tvS}&interval=60&hidesidetoolbar=0&symboledit=1&saveimage=1&toolbarbg=ffffff&theme=light&style=1&timezone=Europe%2FIstanbul&withdateranges=1&locale=en`}
      style={{flex:1,border:"none",width:"100%"}} allowFullScreen/>
  </div></div>
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  MAIN APP
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function App(){
  const[lang,setLang]=useState("en");const L=LANG[lang];
  const[market,setMarket]=useState("crypto");
  const[view,setView]=useState("spot");
  const[raw,setRaw]=useState({bs:[],bf:[],by:[],ok:[],ga:[],mx:[],tv:[],fund:{}});
  const[cg,setCg]=useState([]);const[fg,setFg]=useState(null);
  const[chains,setChains]=useState([]);const[dex,setDex]=useState([]);
  const[busy,setBusy]=useState(false);
  const[search,setSearch]=useState("");const[sortC,setSortC]=useState("vol");const[sortD,setSortD]=useState("desc");
  const[exF,setExF]=useState(new Set(EXL.map(e=>e.id)));
  const[sigF,setSigF]=useState("ALL");const[tvF,setTvF]=useState("volume");
  const[last,setLast]=useState(null);const[clk,setClk]=useState("");
  const[sel,setSel]=useState(null);const[chartSym,setChartSym]=useState(null);
  const[st,setSt]=useState({});const[alerts,setAlerts]=useState([]);
  const[wF,setWF]=useState("all");
  const seen=useRef(new Set());

  useEffect(()=>{const t=setInterval(()=>setClk(new Date().toUTCString().match(/(\d\d:\d\d:\d\d)/)?.[1]||""),1000);return()=>clearInterval(t)},[]);

  const load=useCallback(async()=>{
    setBusy(true);const s={};
    const r=await Promise.allSettled([
      fetchBinanceSpot().then(d=>{s.BinS=d.length;return["bs",d]}),
      fetchBinanceFut().then(d=>{s.BinF=d.length;return["bf",d]}),
      fetchFunding().then(d=>{s.Fund=Object.keys(d).length;return["fund",d]}),
      fetchBybit().then(d=>{s.Bybit=d.length;return["by",d]}),
      fetchOKX().then(d=>{s.OKX=d.length;return["ok",d]}),
      fetchGate().then(d=>{s.Gate=d.length;return["ga",d]}),
      fetchMEXC().then(d=>{s.MEXC=d.length;return["mx",d]}),
      fetchBitget().then(d=>{s.Bitget=d.length;return["bg",d]}),
      fetchTV(tvF).then(d=>{s.TV=d.length;return["tv",d]}),
    ]);
    const n={bs:[],bf:[],by:[],ok:[],ga:[],mx:[],bg:[],tv:[],fund:{}};
    r.forEach(x=>{if(x.status==="fulfilled"&&x.value){const[k,v]=x.value;n[k]=v}});
    setRaw(n);setSt(s);setLast(new Date());setBusy(false);
  },[tvF]);

  const loadExtra=useCallback(async()=>{
    const[a,b,c,d]=await Promise.allSettled([fetchCG(),fetchFG(),fetchDL(),fetchDS()]);
    if(a.status==="fulfilled"&&a.value)setCg(a.value);
    if(b.status==="fulfilled")setFg(b.value);
    if(c.status==="fulfilled"&&c.value)setChains(c.value.sort((a,b)=>(b.tvl||0)-(a.tvl||0)).slice(0,20));
    if(d.status==="fulfilled"&&Array.isArray(d.value))setDex(d.value.slice(0,20));
  },[]);

  useEffect(()=>{load();loadExtra();const t=setInterval(load,15000);const t2=setInterval(loadExtra,60000);return()=>{clearInterval(t);clearInterval(t2)}},[load,loadExtra]);

  // Merge all exchange data
  const merged=useMemo(()=>{
    const all=[];const fm=raw.fund||{};const cgm={};(cg||[]).forEach(c=>cgm[c.symbol?.toUpperCase()]=c);
    (raw.tv||[]).forEach(t=>{
      const sym=(t.name||"").split(":").pop()?.replace(/USDT|USD/g,"")||"";
      const exS=(t.exchange||t.name?.split(":")?.[0]||"").toUpperCase();
      let eid="binance";if(exS.includes("BYBIT"))eid="bybit";else if(exS.includes("OKX"))eid="okx";else if(exS.includes("GATE"))eid="gateio";else if(exS.includes("MEXC"))eid="mexc";
      const g=cgm[sym.toUpperCase()];const f=fm[sym];
      const o={sym,ex:eid,type:t.name?.includes("PERP")?"FUTURES":"SPOT",price:t.close,ch:t.change,vol:t.vol,mcap:t.mcap||(g?.market_cap),rsi:t.rsi,ema20:t.ema20,ema50:t.ema50,rec:t.rec,avgVol:t.avgVol,fr:f?.fr,desc:t.desc||(g?.name),src:"TV",_id:"tv_"+t._id,img:g?.image,rank:g?.market_cap_rank,ch1h:g?.price_change_percentage_1h_in_currency,ch7d:g?.price_change_percentage_7d_in_currency};
      o._a=calcScore(o);all.push(o);
    });
    const addCex=arr=>arr.forEach(t=>{
      const k=t.sym+"_"+t.ex+"_"+t.type;if(all.find(a=>a._id===k))return;
      const g=cgm[t.sym.toUpperCase()];const f=fm[t.sym];
      const o={...t,mcap:g?.market_cap,desc:g?.name,fr:f?.fr,img:g?.image,rank:g?.market_cap_rank,ch1h:g?.price_change_percentage_1h_in_currency,ch7d:g?.price_change_percentage_7d_in_currency,_id:k,rsi:null,ema20:null,ema50:null,rec:null,avgVol:null,src:"CEX"};
      o._a=calcScore(o);all.push(o);
    });
    addCex(raw.bs);addCex(raw.bf);addCex(raw.by);addCex(raw.ok);addCex(raw.ga);addCex(raw.mx);addCex(raw.bg||[]);
    all.filter(t=>t._a.level==="STRONG").forEach(t=>{
      const k=t._id+"_"+Math.floor(Date.now()/180000);
      if(!seen.current.has(k)){seen.current.add(k);setAlerts(p=>[{id:k,ts:new Date(),...t},...p].slice(0,80))}
    });
    return all;
  },[raw,cg]);

  // Filtered data
  const filtered=useMemo(()=>{
    let d=[...merged];
    if(view==="spot")d=d.filter(t=>t.type==="SPOT");else if(view==="futures")d=d.filter(t=>t.type==="FUTURES");
    if(exF.size<EXL.length)d=d.filter(t=>exF.has(t.ex));
    if(sigF!=="ALL")d=d.filter(t=>t._a.level===sigF);
    if(search){const s=search.toUpperCase();d=d.filter(t=>(t.sym||"").toUpperCase().includes(s)||(t.desc||"").toUpperCase().includes(s))}
    const m=new Map();d.forEach(t=>{const k=t.sym+"_"+t.type;if(!m.has(k)||t.src==="TV")m.set(k,t)});d=Array.from(m.values());
    d.sort((a,b)=>{let va,vb;switch(sortC){case"sym":return sortD==="asc"?(a.sym||"").localeCompare(b.sym):(b.sym||"").localeCompare(a.sym);case"price":va=a.price||0;vb=b.price||0;break;case"ch":va=a.ch||0;vb=b.ch||0;break;case"vol":va=a.vol||0;vb=b.vol||0;break;case"mcap":va=a.mcap||0;vb=b.mcap||0;break;case"rsi":va=a.rsi||50;vb=b.rsi||50;break;case"score":va=a._a.score;vb=b._a.score;break;default:va=a.vol||0;vb=b.vol||0}return sortD==="asc"?va-vb:vb-va});
    return d;
  },[merged,view,exF,sigF,search,sortC,sortD]);

  const sC=merged.filter(t=>t.type==="SPOT").length,fC2=merged.filter(t=>t.type==="FUTURES").length;
  const hs=c=>{if(sortC===c)setSortD(d=>d==="asc"?"desc":"asc");else{setSortC(c);setSortD("desc")}};
  const si=c=>sortC===c?(sortD==="asc"?" ‚Üë":" ‚Üì"):"";
  const mk=MARKETS[market];
  const whales=wF==="buy"?WHALE_DB.filter(w=>w.action==="BUY"):wF==="sell"?WHALE_DB.filter(w=>w.action==="SELL"):WHALE_DB;

  const isCrypto=["crypto","cex","dex"].includes(market);

  // ‚ïê‚ïê‚ïê STYLES (v4.1 light) ‚ïê‚ïê‚ïê
  const th={padding:"10px 14px",textAlign:"left",fontSize:13,fontWeight:700,color:T.g500,letterSpacing:.5,textTransform:"uppercase",borderBottom:"1px solid var(--g100)",position:"sticky",top:0,background:T.white,cursor:"pointer",userSelect:"none",whiteSpace:"nowrap",fontFamily:"var(--mono)"};
  const td={padding:"10px 14px",borderBottom:"1px solid var(--g50)",fontSize:15,whiteSpace:"nowrap"};
  const btn=(act,c=T.blue)=>({padding:"8px 14px",fontSize:13,fontWeight:600,background:act?c+"12":"transparent",border:"1px solid "+(act?c+"30":"var(--g200)"),color:act?c:T.g500,borderRadius:100,cursor:"pointer",fontFamily:"var(--sans)",transition:"all .15s"});

  // ‚ïê‚ïê‚ïê RENDER ‚ïê‚ïê‚ïê
  return<div style={{display:"flex",height:"100vh",overflow:"hidden"}}>
    {chartSym&&<ChartModal sym={chartSym} onClose={()=>setChartSym(null)} L={L}/>}

    {/* ‚ïê‚ïê‚ïê SIDEBAR ‚ïê‚ïê‚ïê */}
    <div style={{width:230,flexShrink:0,background:T.white,borderRight:"1px solid var(--g200)",display:"flex",flexDirection:"column",height:"100vh"}}>
      {/* Logo */}
      <div style={{padding:"16px 16px 12px",borderBottom:"1px solid var(--g100)"}}>
        <a href="/" style={{display:"flex",alignItems:"center",gap:10,textDecoration:"none"}}>
          <div style={{width:32,height:32,background:T.ink,borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center",fontFamily:"var(--mono)",fontWeight:700,fontSize:14,color:T.white,letterSpacing:-.5}}>PX</div>
          <span style={{fontFamily:"var(--mono)",fontWeight:600,fontSize:16,color:T.ink,letterSpacing:3}}>PROPTREX</span>
        </a>
      </div>
      {/* Markets */}
      <div style={{padding:"8px 8px",flex:1,overflowY:"auto"}}>
        <div style={{fontSize:12,color:T.g400,letterSpacing:2,textTransform:"uppercase",padding:"10px 10px 6px",fontWeight:700}}>Markets</div>
        {Object.entries(MARKETS).map(([k,v])=>{const act=market===k;return(
          <div key={k} onClick={()=>{setMarket(k);if(["crypto","cex"].includes(k))setView("spot");else if(k==="dex")setView("defi");else setView("all")}}
            style={{display:"flex",alignItems:"center",gap:10,padding:"9px 12px",cursor:"pointer",borderRadius:10,marginBottom:2,transition:"all .15s",
              background:act?v.color+"10":"transparent",borderLeft:act?"3px solid "+v.color:"3px solid transparent"}}
            onMouseEnter={e=>{if(!act)e.currentTarget.style.background=T.g50}}
            onMouseLeave={e=>{if(!act)e.currentTarget.style.background="transparent"}}>
            <span style={{fontSize:20}}>{v.icon}</span>
            <div style={{flex:1}}>
              <div style={{fontSize:15,fontWeight:act?700:500,color:act?T.ink:T.g600}}>{v.label}</div>
              {act&&<div style={{fontSize:11,color:T.g400,marginTop:1}}>{v.agent}</div>}
            </div>
            {act&&<div style={{display:"flex",alignItems:"center",gap:4}}><div style={{width:6,height:6,borderRadius:"50%",background:v.color,boxShadow:"0 0 8px "+v.color+"66",animation:"pulse 2s infinite"}}/><span style={{fontSize:10,color:v.color,fontWeight:700,fontFamily:"var(--mono)"}}>{v.agentStatus}</span></div>}
          </div>
        )})}
      </div>
      {/* Bottom */}
      <div style={{padding:"12px 12px",borderTop:"1px solid var(--g100)"}}>
        <div style={{display:"flex",gap:6,marginBottom:8}}>
          <button onClick={()=>setLang(l=>l==="en"?"tr":"en")} style={{flex:1,padding:"6px 0",background:T.g50,border:"1px solid var(--g200)",color:T.g600,borderRadius:8,fontSize:13,fontWeight:600,cursor:"pointer",fontFamily:"var(--sans)"}}>üåê {L.lang}</button>
          <a href="/" style={{flex:1,padding:"6px 0",background:T.ink,color:T.white,borderRadius:8,fontSize:13,fontWeight:600,textDecoration:"none",textAlign:"center",display:"block"}}>{L.home}</a>
        </div>
        <div style={{fontFamily:"var(--mono)",fontSize:12,color:T.g400}}>UTC {clk}</div>
      </div>
    </div>

    {/* ‚ïê‚ïê‚ïê MAIN AREA ‚ïê‚ïê‚ïê */}
    <div style={{flex:1,display:"flex",flexDirection:"column",minWidth:0,overflow:"hidden",background:T.g50}}>

      {/* TOP BAR */}
      <div style={{height:58,background:T.white,borderBottom:"1px solid var(--g200)",display:"flex",alignItems:"center",padding:"0 20px",gap:14,flexShrink:0}}>
        <span style={{fontSize:28}}>{mk.icon}</span>
        <div>
          <div style={{fontFamily:"var(--mono)",fontSize:18,fontWeight:700,color:T.ink,letterSpacing:.5}}>{mk.label.toUpperCase()}</div>
          <div style={{fontSize:13,color:T.g400}}>{mk.sub}</div>
        </div>
        <div style={{display:"flex",alignItems:"center",gap:6,background:mk.color+"08",border:"1px solid "+mk.color+"20",borderRadius:100,padding:"7px 14px"}}>
          <div style={{width:6,height:6,borderRadius:"50%",background:mk.color,animation:"pulse 2s infinite"}}/> 
          <span style={{fontSize:13,fontWeight:700,color:mk.color,fontFamily:"var(--mono)"}}>{mk.agent}</span>
        </div>
        {fg&&isCrypto&&<div style={{display:"flex",alignItems:"center",gap:6,background:T.g50,border:"1px solid var(--g200)",borderRadius:10,padding:"7px 16px",marginLeft:8}}>
          <span style={{fontSize:12,color:T.g400,fontFamily:"var(--mono)"}}>{L.fgLabel}</span>
          <span style={{fontSize:22,fontWeight:800,color:+fg.value<=25?T.red:+fg.value<=50?T.gold:+fg.value<=75?"#6abf40":T.green,fontFamily:"var(--mono)"}}>{fg.value}</span>
        </div>}
        <div style={{marginLeft:"auto",display:"flex",gap:6,alignItems:"center"}}>
          {Object.entries(st).slice(0,5).map(([k,v])=><span key={k} style={{fontSize:11,padding:"4px 10px",background:v>0?T.green+"10":T.red+"10",color:v>0?T.green:T.red,borderRadius:100,fontWeight:700,fontFamily:"var(--mono)"}}>{v>0?"‚úì":"‚úó"}{k}</span>)}
          {busy&&<span style={{color:T.blue,fontSize:13,animation:"pulse 1s infinite",fontFamily:"var(--mono)"}}>‚ü≥</span>}
          {last&&<span style={{fontSize:12,color:T.g400,fontFamily:"var(--mono)"}}>{L.last}: {last.toLocaleTimeString(lang==="tr"?"tr-TR":"en-US")}</span>}
        </div>
      </div>

      {/* SOCIAL TICKER ‚Äî animated marquee */}
      {isCrypto&&<div style={{background:T.white,borderBottom:"1px solid var(--g100)",overflow:"hidden",display:"flex",alignItems:"center",flexShrink:0,position:"relative"}}>
        <span style={{color:T.red,fontSize:11,fontWeight:700,padding:"6px 14px",whiteSpace:"nowrap",display:"flex",alignItems:"center",borderRight:"1px solid var(--g100)",background:T.white,zIndex:2,fontFamily:"var(--mono)"}}>‚óè LIVE</span>
        <div style={{overflow:"hidden",flex:1,position:"relative"}}>
          <div style={{display:"flex",width:"max-content",animation:"tickerScroll 40s linear infinite"}}>
            {[...SOCIAL,...SOCIAL].map((n,i)=><span key={i} style={{whiteSpace:"nowrap",fontSize:12,padding:"7px 16px",color:T.g500,display:"inline-flex",alignItems:"center",gap:5}}>
              <span>{n.icon}</span><span style={{color:n.hot?T.gold:T.g400,fontWeight:600}}>[{n.src}]</span><span>{n.msg}</span>
              {n.hot&&<span style={{color:T.red,fontSize:10}}>üî•</span>}
              <span style={{color:T.g300,padding:"0 4px"}}>¬∑</span>
            </span>)}
          </div>
        </div>
        <style>{"@keyframes tickerScroll{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}"}</style>
      </div>}

      {/* TABS ‚Äî changes per market */}
      {isCrypto?<div style={{display:"flex",gap:6,padding:"8px 20px",background:T.white,borderBottom:"1px solid var(--g100)",flexShrink:0,flexWrap:"wrap",alignItems:"center"}}>
        {/* View tabs */}
        {[["spot",L.spot,sC],["futures",L.futures,fC2],["all",L.all,merged.length],["defi",L.defi,chains.length],["whales",L.whales,WHALE_DB.length],["alerts",L.alerts,alerts.length]].map(([k,l,n])=>
          <span key={k} style={{padding:"8px 16px",fontSize:14,fontWeight:view===k?700:500,color:view===k?mk.color:T.g500,background:view===k?mk.color+"10":"transparent",borderRadius:100,cursor:"pointer",transition:"all .15s"}} onClick={()=>setView(k)}>{l} <span style={{fontSize:12,color:T.g400}}>({n})</span></span>)}
        <span style={{width:1,height:18,background:"var(--g200)"}}/>
        {/* Signal filters */}
        {[["ALL",L.filterAll],["STRONG",L.filterStrong],["BUY",L.filterBuy],["WATCH",L.filterWatch]].map(([v,l])=>
          <Tip key={v} text={l}><span style={btn(sigF===v,mk.color)} onClick={()=>setSigF(v)}>{l}</span></Tip>)}
        <span style={{width:1,height:18,background:"var(--g200)"}}/>
        {/* TV presets */}
        {[["volume","üìä",L.tvVol],["gainers","üìà",L.tvGain],["oversold","‚ö°",L.tvOversold],["dip","üéØ",L.tvDip],["whale","üêã",L.tvWhale]].map(([v,icon,tip])=>
          <Tip key={v} text={tip}><span style={btn(tvF===v,T.gold)} onClick={()=>setTvF(v)}>{icon} {tip}</span></Tip>)}
        <span style={{width:1,height:18,background:"var(--g200)"}}/>
        {/* Exchange chips */}
        {EXL.map(e=>{const a=exF.has(e.id);return<span key={e.id} style={{padding:"5px 10px",fontSize:12,fontWeight:600,background:a?e.c+"10":"transparent",border:"1px solid "+(a?e.c+"28":"var(--g200)"),color:a?e.c:T.g400,borderRadius:100,cursor:"pointer",fontFamily:"var(--mono)"}} onClick={()=>{const s=new Set(exF);s.has(e.id)?s.delete(e.id):s.add(e.id);setExF(s)}}>{e.n}</span>})}
        <span style={{width:1,height:18,background:"var(--g200)"}}/>
        <span style={{color:T.g400,fontSize:16}}>üîç</span>
        <input style={{maxWidth:200,background:T.g50,border:"1px solid var(--g200)",color:T.ink,borderRadius:100,padding:"8px 16px",fontSize:14,fontFamily:"var(--sans)",outline:"none"}} placeholder={L.search} value={search} onChange={e=>setSearch(e.target.value)}/>
      </div>:
      <div style={{display:"flex",gap:6,padding:"8px 20px",background:T.white,borderBottom:"1px solid var(--g100)",flexShrink:0}}>
        <span style={{fontFamily:"var(--mono)",fontSize:14,fontWeight:700,color:T.ink}}>{mk.label}</span>
        <span style={{fontSize:13,color:T.g400}}>‚Äî {market==="stocks"?"Global Indices + AI Signals":market==="etf"?"Bitcoin ETF Flows":market==="bonds"?"Yield Curve + Global 10Y":"Data"}</span>
      </div>}

      {/* ‚ïê‚ïê‚ïê CONTENT ‚ïê‚ïê‚ïê */}
      <div style={{flex:1,overflowY:"auto",minHeight:0}}>
        {/* CRYPTO TABLE */}
        {isCrypto&&!["defi","whales","alerts"].includes(view)&&<table style={{width:"100%",borderCollapse:"collapse",background:T.white}}>
          <thead><tr>
            <th style={{...th,width:32}}>#</th>
            <th style={th} onClick={()=>hs("sym")}>{L.symbol}{si("sym")}</th>
            <th style={th}>{L.type}</th><th style={th}>{L.exchange}</th>
            <th style={th} onClick={()=>hs("price")}>{L.price}{si("price")}</th>
            <th style={th} onClick={()=>hs("ch")}>{L.change24}{si("ch")}</th>
            <th style={th} onClick={()=>hs("vol")}>{L.volume}{si("vol")}</th>
            <th style={th} onClick={()=>hs("mcap")}>{L.mcap}{si("mcap")}</th>
            <th style={th} onClick={()=>hs("rsi")}>{L.rsi}{si("rsi")}</th>
            <th style={th}>{L.fund}</th>
            <th style={th} onClick={()=>hs("score")}>{L.score}{si("score")}</th>
            <th style={th}>{L.signal}</th><th style={th}>{L.trade}</th>
          </tr></thead><tbody>
            {filtered.length===0&&<tr><td colSpan={13} style={{...td,textAlign:"center",color:T.g400,padding:50}}>{busy?L.loading:L.noData}</td></tr>}
            {filtered.slice(0,500).map((d,i)=>{const ex=EX[d.ex];const s=sel===d._id;
              return<tr key={d._id} style={{background:s?T.blue+"06":"transparent",cursor:"pointer",transition:"background .1s"}} onClick={()=>{setSel(s?null:d._id);setChartSym(d.sym)}}
                onMouseEnter={e=>e.currentTarget.style.background=T.g50} onMouseLeave={e=>e.currentTarget.style.background=s?T.blue+"06":"transparent"}>
                <td style={{...td,color:T.g400,fontSize:13}}>{i+1}</td>
                <td style={td}><div style={{display:"flex",alignItems:"center",gap:6}}>
                  {d.img&&<img src={d.img} width={18} height={18} style={{borderRadius:"50%"}}/>}
                  <span style={{fontWeight:700,color:T.ink,fontSize:16}}>{d.sym}</span>
                  {d.desc&&<span style={{fontSize:13,color:T.g400}}>{(d.desc||"").slice(0,16)}</span>}
                  {d.rank&&<span style={{fontSize:11,color:T.g400,fontFamily:"var(--mono)"}}>#{d.rank}</span>}
                </div></td>
                <td style={td}><TPill t={d.type}/></td>
                <td style={td}><Badge id={d.ex}/></td>
                <td style={{...td,fontWeight:700,color:T.ink,fontSize:16}}>{fP(d.price)}</td>
                <td style={{...td,fontWeight:700,color:pC(d.ch),fontSize:15}}>{fC(d.ch)}</td>
                <td style={{...td,color:T.g500}}>{fU(d.vol)}</td>
                <td style={{...td,color:T.g500}}>{fU(d.mcap)}</td>
                <td style={td}>{d.rsi!=null?<span style={{fontWeight:700,fontSize:15,color:d.rsi<30?T.green:d.rsi>70?T.red:T.g500}}>{d.rsi.toFixed(0)}</span>:<span style={{color:T.g300}}>‚Äî</span>}</td>
                <td style={td}>{d.fr!=null?<span style={{fontWeight:700,color:d.fr<0?T.green:d.fr>0.03?T.red:T.g500,fontFamily:"var(--mono)",fontSize:14}}>{d.fr.toFixed(3)}%</span>:<span style={{color:T.g300}}>‚Äî</span>}</td>
                <td style={td}><SBar s={d._a.score} l={d._a.level}/></td>
                <td style={td}><LPill l={d._a.level}/></td>
                <td style={td}><div style={{display:"flex",gap:4}}>
                  {ex&&<a href={ex.l(d.sym)} target="_blank" rel="noopener noreferrer" style={{background:T.ink,color:T.white,borderRadius:6,padding:"5px 12px",fontSize:12,fontWeight:600,textDecoration:"none"}} onClick={e=>e.stopPropagation()}>{L.openEx} ‚Üó</a>}
                  <span style={{background:T.blue+"10",color:T.blue,borderRadius:6,padding:"5px 12px",fontSize:12,fontWeight:600,cursor:"pointer"}} onClick={e=>{e.stopPropagation();setChartSym(d.sym)}}>üìà</span>
                </div></td>
              </tr>})}
          </tbody></table>}

          {/* DEFI TAB */}
          {isCrypto&&view==="defi"&&<div style={{padding:20}}>
            <div style={{background:T.white,border:"1px solid var(--g200)",borderRadius:14,padding:16,marginBottom:14}}>
              <div style={{fontSize:14,color:T.g500,letterSpacing:1,marginBottom:10,fontWeight:700,fontFamily:"var(--mono)"}}>üîó {L.chainTvl} ‚Äî DefiLlama</div>
              {chains.slice(0,12).map((ch,i)=>{const mx=chains[0]?.tvl||1;return<div key={ch.name} style={{display:"flex",alignItems:"center",gap:8,marginBottom:5}}>
                <span style={{fontSize:13,color:T.g400,width:20,fontFamily:"var(--mono)"}}>{i+1}</span>
                <span style={{fontSize:14,color:T.ink,width:80,fontWeight:700}}>{ch.name}</span>
                <div style={{flex:1,height:10,background:T.g100,borderRadius:100,overflow:"hidden"}}><div style={{width:(ch.tvl/mx*100)+"%",height:"100%",background:"linear-gradient(90deg,"+T.blue+","+T.purple+")",borderRadius:100}}/></div>
                <span style={{fontSize:14,color:T.blue,minWidth:70,textAlign:"right",fontWeight:700,fontFamily:"var(--mono)"}}>{fU(ch.tvl)}</span>
              </div>})}
            </div>
            <div style={{background:T.white,border:"1px solid var(--g200)",borderRadius:14,padding:16}}>
              <div style={{fontSize:14,color:T.g500,letterSpacing:1,marginBottom:10,fontWeight:700,fontFamily:"var(--mono)"}}>üî• {L.trendTokens} ‚Äî DexScreener</div>
              <div style={{display:"flex",gap:8,flexWrap:"wrap"}}>{dex.map((t,i)=><div key={i} style={{background:T.g50,border:"1px solid var(--g200)",borderRadius:10,padding:"8px 14px",fontSize:13,minWidth:140}}>
                <div style={{fontWeight:700,color:T.ink}}>{t.tokenAddress?.slice(0,8)}‚Ä¶</div>
                <div style={{color:T.g400,fontSize:12}}>{t.chainId} ¬∑ boost:{t.amount}</div>
                {t.url&&<a href={t.url} target="_blank" rel="noopener noreferrer" style={{color:T.blue,fontSize:12,textDecoration:"none"}}>‚Üó</a>}
              </div>)}</div>
            </div>
          </div>}

          {/* WHALES TAB */}
          {isCrypto&&view==="whales"&&<div style={{padding:20}}>
            <div style={{display:"flex",gap:6,marginBottom:12}}>
              {[["all",L.whaleAll,"üêã"],["buy",L.whaleBuy,"üíö"],["sell",L.whaleSell,"üî¥"]].map(([k,l,icon])=>
                <span key={k} style={btn(wF===k,T.green)} onClick={()=>setWF(k)}>{icon} {l}</span>)}
            </div>
            {whales.map(w=>{const isB=w.action==="BUY";return<div key={w.id} style={{background:T.white,border:"1px solid "+(isB?"var(--green-l)":"var(--red-l)"),borderRadius:12,padding:"12px 16px",marginBottom:6}}>
              <div style={{display:"flex",gap:10,alignItems:"center",flexWrap:"wrap"}}>
                <span style={{fontSize:24}}>{isB?"üêã":"‚ö†Ô∏è"}</span>
                <span style={{background:isB?T.green+"14":T.red+"14",color:isB?T.green:T.red,borderRadius:100,padding:"4px 12px",fontSize:13,fontWeight:700}}>{w.action}</span>
                <span style={{fontWeight:700,color:T.ink,fontSize:18}}>{w.token}</span>
                <span style={{fontSize:12,color:T.g400,fontFamily:"var(--mono)"}}>{w.chain}</span>
                <span style={{color:isB?T.green:T.red,fontWeight:700,fontSize:16}}>{fU(w.amount)}</span>
                <span style={{fontSize:12,color:T.g400}}>{w.label}</span>
                <span style={{marginLeft:"auto",fontSize:12,color:T.g400,fontFamily:"var(--mono)"}}>{w.age}m ago</span>
              </div>
              <div style={{marginTop:6,fontSize:12,color:T.g400,display:"flex",gap:8,alignItems:"center"}}>
                <span style={{fontFamily:"var(--mono)",color:T.g500}}>{w.short}</span>
                <span>¬∑ {w.exchange}</span>
                <a href={EX.binance.l(w.token)} target="_blank" rel="noopener noreferrer" style={{background:T.ink,color:T.white,borderRadius:6,padding:"4px 12px",fontSize:12,fontWeight:600,textDecoration:"none",marginLeft:"auto"}}>{isB?"Buy ‚Üí":"Close ‚Üí"}</a>
              </div>
            </div>})}
          </div>}

          {/* ALERTS TAB */}
          {isCrypto&&view==="alerts"&&<div style={{padding:20}}>
            <div style={{fontSize:16,fontWeight:700,color:T.blue,marginBottom:10,fontFamily:"var(--mono)"}}>üö® {L.liveAlerts} ({alerts.length})</div>
            {alerts.map(a=><div key={a.id} style={{background:T.white,border:"1px solid var(--g200)",borderRadius:10,padding:"8px 14px",marginBottom:4,display:"flex",gap:10,alignItems:"center"}}>
              <span style={{fontSize:20}}>üöÄ</span>
              <div style={{flex:1}}><div style={{display:"flex",gap:6,alignItems:"center"}}><span style={{fontWeight:700,color:T.ink,fontSize:16}}>{a.sym}</span><Badge id={a.ex}/><LPill l={a._a?.level}/><SBar s={a._a?.score} l={a._a?.level}/></div>
                <div style={{fontSize:13,color:T.g500,display:"flex",gap:6}}><span>{fP(a.price)}</span><span style={{color:pC(a.ch)}}>{fC(a.ch)}</span>{a._a?.sig?.map((s,i)=><span key={i} style={{color:T.green}}>{s}</span>)}</div>
              </div><span style={{fontSize:12,color:T.g400,fontFamily:"var(--mono)"}}>{a.ts?.toLocaleTimeString(lang==="tr"?"tr-TR":"en-US")}</span>
            </div>)}
          </div>}

          {/* STOCKS */}
          {market==="stocks"&&<div style={{padding:20}}>
            <div style={{background:T.white,border:"1px solid var(--g200)",borderRadius:14,padding:16,marginBottom:14}}>
              <div style={{fontSize:14,color:T.g500,letterSpacing:1,marginBottom:10,fontWeight:700,fontFamily:"var(--mono)"}}>üåç GLOBAL INDICES</div>
              {INDICES.map(idx=><div key={idx.n} style={{display:"flex",alignItems:"center",gap:10,padding:"8px 0",borderBottom:"1px solid var(--g50)"}}>
                <span style={{fontSize:15,fontWeight:700,color:T.ink,flex:1}}>{idx.n}</span>
                <span style={{fontFamily:"var(--mono)",fontSize:16,fontWeight:700,color:T.ink}}>{idx.v}</span>
                <span style={{fontFamily:"var(--mono)",fontSize:14,fontWeight:700,color:idx.up?T.green:T.red,minWidth:60,textAlign:"right"}}>{idx.ch}</span>
              </div>)}
            </div>
          </div>}

          {/* ETF */}
          {market==="etf"&&<div style={{padding:20}}>
            <div style={{background:T.white,border:"1px solid var(--g200)",borderRadius:14,padding:16,marginBottom:14}}>
              <div style={{fontSize:14,color:T.g500,letterSpacing:1,marginBottom:10,fontWeight:700,fontFamily:"var(--mono)"}}>‚Çø BITCOIN ETF DAILY FLOWS</div>
              {ETF_FLOWS.map(f=><div key={f.n} style={{display:"flex",alignItems:"center",gap:10,padding:"8px 0",borderBottom:"1px solid var(--g50)"}}>
                <span style={{fontSize:15,fontWeight:600,color:T.ink,flex:1}}>{f.n}</span>
                <span style={{fontFamily:"var(--mono)",fontSize:15,fontWeight:700,color:f.up?T.green:T.red}}>{f.v}</span>
              </div>)}
            </div>
          </div>}

          {/* BONDS */}
          {market==="bonds"&&<div style={{padding:20}}>
            <div style={{background:T.white,border:"1px solid var(--g200)",borderRadius:14,padding:16,marginBottom:14}}>
              <div style={{fontSize:14,color:T.g500,letterSpacing:1,marginBottom:10,fontWeight:700,fontFamily:"var(--mono)"}}>üè¶ GLOBAL 10Y YIELDS</div>
              {BONDS.map(b=><div key={b.n} style={{display:"flex",alignItems:"center",gap:10,padding:"8px 0",borderBottom:"1px solid var(--g50)"}}>
                <span style={{fontSize:15,fontWeight:600,color:T.ink,flex:1}}>{b.n}</span>
                <span style={{fontFamily:"var(--mono)",fontSize:16,fontWeight:700,color:T.ink}}>{b.v}</span>
                <span style={{fontFamily:"var(--mono)",fontSize:14,fontWeight:700,color:b.up?T.green:T.red,minWidth:50,textAlign:"right"}}>{b.ch}</span>
              </div>)}
              <div style={{marginTop:12,fontSize:15,color:T.red,fontWeight:600}}>‚ö† US Yield Curve Inverted (2Y {">"} 10Y) ‚Äî Recession signal</div>
            </div>
          </div>}
      </div>

      {/* DETAIL BAR */}
      {sel&&isCrypto&&!["defi","whales","alerts"].includes(view)&&(()=>{const d=filtered.find(x=>x._id===sel);if(!d)return null;const ex=EX[d.ex];
        return<div style={{borderTop:"1px solid var(--g200)",background:T.white,padding:"8px 20px",flexShrink:0,display:"flex",gap:12,alignItems:"center",flexWrap:"wrap",fontSize:14}}>
          <span style={{fontWeight:800,color:T.ink,fontSize:18}}>{d.sym}</span><TPill t={d.type}/><Badge id={d.ex}/>
          <span style={{color:T.ink,fontWeight:700,fontSize:16}}>{fP(d.price)}</span><span style={{color:pC(d.ch),fontWeight:700}}>{fC(d.ch)}</span>
          {d.ch1h!=null&&<span style={{color:pC(d.ch1h),fontSize:13}}>1h:{fC(d.ch1h)}</span>}
          {d.ch7d!=null&&<span style={{color:pC(d.ch7d),fontSize:13}}>7d:{fC(d.ch7d)}</span>}
          {d.rsi!=null&&<span style={{color:T.g500}}>RSI:<span style={{fontWeight:700,color:d.rsi<30?T.green:d.rsi>70?T.red:T.ink}}>{d.rsi.toFixed(1)}</span></span>}
          <LPill l={d._a.level}/>
          <div style={{display:"flex",gap:4,flexWrap:"wrap"}}>{d._a.sig?.map((s,i)=><span key={i} style={{fontSize:12,color:T.green,background:T.green+"10",borderRadius:100,padding:"4px 10px"}}>{s}</span>)}</div>
          <div style={{display:"flex",gap:4,marginLeft:"auto"}}>
            {ex&&<a href={ex.l(d.sym)} target="_blank" rel="noopener noreferrer" style={{background:T.ink,color:T.white,borderRadius:8,padding:"7px 16px",fontSize:13,fontWeight:600,textDecoration:"none"}}>{ex.n} ‚Üó</a>}
            <span style={{background:T.blue+"10",color:T.blue,borderRadius:8,padding:"7px 16px",fontSize:13,fontWeight:600,cursor:"pointer"}} onClick={()=>setChartSym(d.sym)}>üìà {L.chart}</span>
          </div>
        </div>})()}

      {/* FOOTER */}
      <div style={{borderTop:"1px solid var(--g100)",padding:"4px 20px",display:"flex",gap:10,fontSize:11,color:T.g400,flexWrap:"wrap",flexShrink:0,background:T.white}}>
        <span style={{fontFamily:"var(--mono)"}}>API: Binance ¬∑ Bybit ¬∑ OKX ¬∑ Gate.io ¬∑ MEXC ¬∑ CoinGecko ¬∑ DefiLlama ¬∑ DexScreener ¬∑ TradingView ¬∑ Fear&Greed</span>
        <span style={{color:T.red}}>‚ö† DYOR</span>
        <span style={{marginLeft:"auto"}}>PROPTREX v4.1</span>
      </div>
    </div>
  </div>;
}
ReactDOM.createRoot(document.getElementById("root")).render(<App/>);
</script>
</body>
</html>
